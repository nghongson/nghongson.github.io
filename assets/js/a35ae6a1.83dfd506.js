"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5438],{2177:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var t=r(4848),o=r(8453);const i={},s=void 0,c={id:"mage2/Asynchronous",title:"Asynchronous",description:"Asynchronous and deferred operations",source:"@site/docs/mage2/Asynchronous.md",sourceDirName:"mage2",slug:"/mage2/Asynchronous",permalink:"/docs/mage2/Asynchronous",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"2FA",permalink:"/docs/mage2/2FA"},next:{title:"Docker Image",permalink:"/docs/mage2/Docker Image"}},a={},d=[{value:"DeferredInterface",id:"DeferredInterface",level:2},{value:"Client code",id:"Client-code",level:2},{value:"ProxyDeferredFactory",id:"ProxyDeferredFactory",level:2}];function l(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Asynchronous and deferred operations\nAsynchronous operations are not native to PHP but it is still possible to execute heavy operations simultaneously, or delay them until they absolutely have to be finished."}),"\n",(0,t.jsx)(n.h2,{id:"DeferredInterface",children:"DeferredInterface"}),"\n",(0,t.jsx)(n.p,{children:"DeferredInterface to use with asynchronous operations. This allows client code to work with asynchronous operations just as it would with standard operations."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Magento\\Framework\\Async\\DeferredInterface\ninterface DeferredInterface\n{\n    /**\n     * @return mixed Value.\n     * @throws \\Throwable\n     */\n    public function get();\n\n    public function isDone(): bool;\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["When the client code needs the result, the ",(0,t.jsx)(n.code,{children:"get()"})," method will be called to retrieve the result.",(0,t.jsx)(n.code,{children:"isDone()"})," can be used to see whether the code has completed.\nThere are 2 types of asynchronous operations where DeferredInterface can be used to describe the result:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"With asynchronous"})," operations in progress, calling get() would wait for them to finish and return their result."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"With deferred"})," operations, get() would actually start the operation, wait for it to finish, and then return the result.\nSometimes tasks, functions require more control over long asynchronous operations."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Magento\\Framework\\Async\\CancelableDeferredInterface\n\ninterface CancelableDeferredInterface extends DeferredInterface\n{\n    /**\n     * @param bool $force Cancel operation even if it's already started.\n     * @return void\n     * @throws CancelingDeferredException When failed to cancel.\n     */\n    public function cancel(bool $force = false): void;\n\n    /**\n     * @return bool\n     */\n    public function isCancelled(): bool;\n}\n\n"})}),"\n",(0,t.jsx)(n.h2,{id:"Client-code",children:"Client code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"public function aMethod() {\n    //Started executing 1st operation\n    $operationA = $serviceA->executeOp();\n\n    //Executing 2nd operations at the same time\n    $operationB = $serviceB->executeOp2();\n\n    //We need to wait for 1st operation to start operation #3\n    $serviceC->executeOp3($operationA->get());\n\n    //We don't have to wait for operation #2, let client code wait for it if it needs the result\n    //Operation number #3 is being executed simultaneously with operation #2\n    return $operationB;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"ProxyDeferredFactory",children:"ProxyDeferredFactory"}),"\n",(0,t.jsx)(n.p,{children:"Using DeferredInterface for background operations\nUsing DeferredInterface for deferred operations"})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var t=r(6540);const o={},i=t.createContext(o);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);