"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1445],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=u(n),d=a,f=c["".concat(s,".").concat(d)]||c[d]||m[d]||o;return n?r.createElement(f,l(l({ref:t},p),{},{components:n})):r.createElement(f,l({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=c;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},6114:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>i,toc:()=>u});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:6},l="Routing",i={unversionedId:"mage2/routing",id:"mage2/routing",title:"Routing",description:"FrontController classes",source:"@site/docs/mage2/routing.md",sourceDirName:"mage2",slug:"/mage2/routing",permalink:"/docs/mage2/routing",draft:!1,tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Request Flow Processing",permalink:"/docs/mage2/request-flow-processing"},next:{title:"Magento UI",permalink:"/docs/mage2/magento-ui"}},s={},u=[{value:"FrontController classes",id:"frontcontroller-classes",level:2},{value:"Standard router",id:"standard-router",level:3},{value:"Custom routers",id:"custom-routers",level:3},{value:"routes.xml",id:"routesxml",level:3},{value:"Action class",id:"action-class",level:3}],p={toc:u};function m(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"routing"},"Routing"),(0,a.kt)("h2",{id:"frontcontroller-classes"},"FrontController classes"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"FrontController: Magento\\Framework\\App\\FrontController")),(0,a.kt)("p",null,"The FrontController class class searches through a list of routers, provided by the RouterList class, until it matches one that can process a request. When the FrontController finds a matching router, it dispatches the request to an action class returned by the router."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"RouterList: Magento\\Framework\\App\\RouterList")),(0,a.kt)("p",null,"The RouterList class collection of routers"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Router class: ")),(0,a.kt)("p",null,"The Router class matches a request to an action class that processes the request.\nImplement Magento\\Framework\\App\\RouterInterface"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"frontend")," area routers:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Router"),(0,a.kt)("th",{parentName:"tr",align:null},"Order"),(0,a.kt)("th",{parentName:"tr",align:null},"Class"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"robots"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Robots\\Controller\\Route"),(0,a.kt)("td",{parentName:"tr",align:null},"Matches request to the robots.txt file")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"urlrewrite"),(0,a.kt)("td",{parentName:"tr",align:null},"20"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\UrlRewrite\\Controller\\Route"),(0,a.kt)("td",{parentName:"tr",align:null},"Matches requests with URL defined in the database")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"standard"),(0,a.kt)("td",{parentName:"tr",align:null},"30"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Framework\\App\\Router\\Base"),(0,a.kt)("td",{parentName:"tr",align:null},"The standard router")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"cms"),(0,a.kt)("td",{parentName:"tr",align:null},"60"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Cms\\Controller\\Route"),(0,a.kt)("td",{parentName:"tr",align:null},"Matches requests for CMS pages")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"default"),(0,a.kt)("td",{parentName:"tr",align:null},"100"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Framework\\App\\Router\\DefaultRoute"),(0,a.kt)("td",{parentName:"tr",align:null},"The default router : set to no-route action")))),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"admin")," area routers:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Router"),(0,a.kt)("th",{parentName:"tr",align:null},"Order"),(0,a.kt)("th",{parentName:"tr",align:null},"Class"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"admin"),(0,a.kt)("td",{parentName:"tr",align:null},"10"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Backend\\App\\Route"),(0,a.kt)("td",{parentName:"tr",align:null},"Matches requests in the Admin area")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"default"),(0,a.kt)("td",{parentName:"tr",align:null},"100"),(0,a.kt)("td",{parentName:"tr",align:null},"Magento\\Framework\\App\\Router\\DefaultRouter"),(0,a.kt)("td",{parentName:"tr",align:null},"The default router for the Admin area")))),(0,a.kt)("h3",{id:"standard-router"},"Standard router"),(0,a.kt)("p",null,"A URL that uses the standard router has the following format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"<store-url>/<store-code>/<front-name>/<controller-name>/<action-name>\nWhere:\n\n* <store-url> - specifies the base URL for the application instance\n* <store-code> - specifies the store context\n* <front-name> - specifies the frontName of the FrontController to use (for example, [routesxml])\n* <controller-name> - specifies the name of the controller\n* <action-name> - specifies the action class to execute on the controller class\n")),(0,a.kt)("h3",{id:"custom-routers"},"Custom routers"),(0,a.kt)("p",null,"Create an implementation of ",(0,a.kt)("inlineCode",{parentName:"p"},"RouterInterface")," to create a custom router, and define the match() function in this class to use your own route matching logic."),(0,a.kt)("p",null,"If you need route configuration data, use the Route Config class."),(0,a.kt)("p",null,"To add your custom router to the list of routers for the ",(0,a.kt)("inlineCode",{parentName:"p"},"FrontController"),", add the following entry in your module's ",(0,a.kt)("inlineCode",{parentName:"p"},"frontend/di.xml")," file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-frontend/di.xml"},'<type name="Magento\\Framework\\App\\RouterList">\n    <arguments>\n        <argument name="routerList" xsi:type="array">\n            <item name="%name%" xsi:type="array">\n                <item name="class" xsi:type="string">%classpath%</item>\n                <item name="disable" xsi:type="boolean">false</item>\n                <item name="sortOrder" xsi:type="string">%sortorder%</item>\n            </item>\n        </argument>\n    </arguments>\n</type>\n\n* %name% - The unique name of your router in Magento.\n* %classpath% - The path to your router class. Example: Magento\\Robots\\Controller\\Router\n* %sortorder% - The sort order of this entry in the router list.\n')),(0,a.kt)("h3",{id:"routesxml"},"routes.xml"),(0,a.kt)("p",null,"The routes.xml file maps which module to use for a URL with a specific frontName and area. The location of the routes.xml file in a module, either etc/frontend or etc/adminhtml, specifies where those routes are active."),(0,a.kt)("p",null,"The content of this file uses the following format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'routes.xml\n<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:App/etc/routes.xsd">\n    <router id="%routerId%">\n        <route id="%routeId%" frontName="%frontName%">\n            <module name="%moduleName%"/>\n        </route>\n    </router>\n</config>\n\n* %routerId - specifies the name of the router in Magento. See the reference tables in the Router class section.\n* %routeId% - specifies the unique node id for this route in Magento, is also the first segment of its associated layout handle XML filename (routeId_controller_action.xml).\n* %frontName% - specifies the first segment after the base URL of a request.\n* %moduleName% - specifies the name of your module.\n\n\n\n')),(0,a.kt)("h3",{id:"action-class"},"Action class"),(0,a.kt)("p",null,"Action classes are implementations of the ",(0,a.kt)("inlineCode",{parentName:"p"},"ActionInterface")," that a router returns on matched requests. The ",(0,a.kt)("inlineCode",{parentName:"p"},"execute()")," function in these classes contain the logic for dispatching requests."),(0,a.kt)("p",null,"Each Action should implement one or more ",(0,a.kt)("inlineCode",{parentName:"p"},"Magento\\Framework\\App\\Action\\Http")," HTTP ",(0,a.kt)("inlineCode",{parentName:"p"},"MethodActionInterface")," to declare which HTTP request methods it can process. The most common ones are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"\\Magento\\Framework\\App\\Action\\HttpDeleteActionInterface")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"\\Magento\\Framework\\App\\Action\\HttpGetActionInterface")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"\\Magento\\Framework\\App\\Action\\HttpPostActionInterface")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"\\Magento\\Framework\\App\\Action\\HttpPutActionInterface"))),(0,a.kt)("p",null,"The application has a form key validation in place for all ",(0,a.kt)("inlineCode",{parentName:"p"},"POST")," non-AJAX requests - if your Action doesn't need that validation or you want to modify it you can implement ",(0,a.kt)("inlineCode",{parentName:"p"},"CsrfAwareActionInterface"),"."))}m.isMDXComponent=!0}}]);