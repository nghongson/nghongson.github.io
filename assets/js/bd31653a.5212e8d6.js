"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[454],{5744:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>a});var i=l(4848),t=l(8453);const s={},o="Determine the layout initialization process",r={id:"mage2/ layout-initialization-process",title:"Determine the layout initialization process",description:"Determine how layout is compiled.",source:"@site/docs/mage2/ layout-initialization-process.md",sourceDirName:"mage2",slug:"/mage2/ layout-initialization-process",permalink:"/docs/mage2/ layout-initialization-process",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Security on Magento",permalink:"/docs/mage2/security"},next:{title:"2FA",permalink:"/docs/mage2/2FA"}},d={},a=[{value:"Determine how layout is compiled.",id:"Determine-how-layout-is-compiled",level:2},{value:"How would you debug your layout.xml files and verify that the right layout instructions are used?",id:"How-would-you-debug-your-layoutxml-files-and-verify-that-the-right-layout-instructions-are-used",level:3},{value:"Determine how HTML output is rendered.",id:"Determine-how-HTML-output-is-rendered",level:2},{value:"How does Magento flush output, and what mechanisms exist to access and customize output?",id:"How-does-Magento-flush-output-and-what-mechanisms-exist-to-access-and-customize-output",level:3},{value:"Determine module layout XML schema.",id:"Determine-module-layout-XML-schema",level:2},{value:"layout_generic.xsd",id:"layout_genericxsd",level:3},{value:"page_configuration.xsd",id:"page_configurationxsd",level:3},{value:"layouts.xml - declare available page layouts",id:"layoutsxml---declare-available-page-layouts",level:3},{value:"page_layout.xsd",id:"page_layoutxsd",level:3},{value:"layout result.renderResult:",id:"layout-resultrenderResult",level:3},{value:"page result.renderResult:",id:"page-resultrenderResult",level:3},{value:"In your custom controller don&#39;t forget to add entity-specific IDs:",id:"In-your-custom-controller-dont-forget-to-add-entity-specific-IDs",level:3},{value:"File Collector",id:"File-Collector",level:3},{value:"How do you add new elements to the pages introduced by a given module?",id:"How-do-you-add-new-elements-to-the-pages-introduced-by-a-given-module",level:3},{value:"Demonstrate the ability to use layout fallback for customizations and debugging.",id:"Demonstrate-the-ability-to-use-layout-fallback-for-customizations-and-debugging",level:2},{value:"How do you identify which exact layout.xml file is processed in a given scope?",id:"How-do-you-identify-which-exact-layoutxml-file-is-processed-in-a-given-scope",level:3},{value:"How does Magento treat layout XML files with the same names in different modules?",id:"How-does-Magento-treat-layout-XML-files-with-the-same-names-in-different-modules",level:2},{value:"Identify the differences between admin and frontend scopes.",id:"Identify-the-differences-between-admin-and-frontend-scopes",level:2},{value:"What differences exist for layout initialization for the admin scope?",id:"What-differences-exist-for-layout-initialization-for-the-admin-scope",level:3}];function c(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"Determine-the-layout-initialization-process",children:"Determine the layout initialization process"}),"\n",(0,i.jsx)(n.h2,{id:"Determine-how-layout-is-compiled",children:"Determine how layout is compiled."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Layout::*build* = View\\Layout\\Builder::*build* - once"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["loadLayoutUpdates - reads layout xml files and DB updates by ",(0,i.jsx)(n.em,{children:"current handles"}),", result in ",(0,i.jsx)(n.code,{children:"_updates"})," array"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["event ",(0,i.jsx)(n.code,{children:"layout_load_before"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["generateLayoutXml - joins ",(0,i.jsx)(n.code,{children:"_updates"})," into XML string, loads XML object, initiailzes ",(0,i.jsx)(n.code,{children:"_elements"})," = []"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"layout.generateXml"}),"\n",(0,i.jsx)(n.li,{children:"no events"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"generateLayoutBlocks - layout.generateElements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["event ",(0,i.jsx)(n.code,{children:"layout_generate_blocks_before"})]}),"\n",(0,i.jsx)(n.li,{children:"readerPool->interpret - every reader checks for matching xml node name (attribute, body, head etc.), prepares page structure"}),"\n",(0,i.jsx)(n.li,{children:"generatorPool->process"}),"\n",(0,i.jsx)(n.li,{children:'add top-level element as outputElement. default "root"'}),"\n",(0,i.jsxs)(n.li,{children:["event ",(0,i.jsx)(n.code,{children:"layout_generate_blocks_after"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"builder.generateLayoutBlocks -> layout.generateElements\nreaderPool.*interpret* -- schedules\n  nodeReaders[type].interpret each element -- `Layout\\ReaderInterface`\n  - html, move\n  - body - own readerPool.interpret, but without 'body' reader\n  - head - css,script,link,remove,meta,title,attribute\n  - 'container', 'referenceContainer' --\x3e Layout\\Reader\\Container\n  - 'block', 'referenceBlock' --\x3e Layout\\Reader\\Block\n  - uiComponent\n  `View\\Layout\\ReaderInterface::interpret` -- html, body, head, ui component, reader pool, container, move, block\n\nView\\Layout\\GeneratorPool.process -- generates blocks\n  buildStructure\n  generator[].*process*\n  - head, body\n  - block - creates blocks, sets layout, event `core_layout_block_create_after`, block 'actions'\n  - container - sets tag, id, class, label, display\n  - uiComponent - creates wrapper element, prepareComponent recursively etc.\n\ngetOutput\n- renderElement(root)\n  - renderNonCachedElement(root) -- hardcoded switch\n    - is uiComponent -> toHtml\n    - is block -> toHtml\n    - is container -> renderElement(child[])\n  - event `core_layout_render_element`\n"})}),"\n",(0,i.jsx)(n.h3,{id:"How-would-you-debug-your-layoutxml-files-and-verify-that-the-right-layout-instructions-are-used",children:"How would you debug your layout.xml files and verify that the right layout instructions are used?"}),"\n",(0,i.jsxs)(n.p,{children:["When XML object is created from string XML updates, this is a good place to examine resuls.\n",(0,i.jsx)(n.code,{children:"View\\Layout\\Builder.generateLayoutXml"})," or ",(0,i.jsx)(n.code,{children:"View\\Layout.generateXml"})," is a good place to dump structure."]}),"\n",(0,i.jsx)(n.h2,{id:"Determine-how-HTML-output-is-rendered",children:"Determine how HTML output is rendered."}),"\n",(0,i.jsxs)(n.p,{children:["First external code calls layout.addOutputElement(name) to register top level elements for output generation.\nWhen layout.",(0,i.jsx)(n.em,{children:"getOutput"})," is called, it renders each outputElement."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"View\\Layout::getOutput"})}),"\n",(0,i.jsxs)(n.li,{children:["for every registered ",(0,i.jsx)(n.code,{children:"_output"})," element"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"View\\Layout::renderElement"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:'When layout is build initially, it finds top level container and registers it as addOutputElement - default "root".'}),"\n",(0,i.jsx)(n.h3,{id:"How-does-Magento-flush-output-and-what-mechanisms-exist-to-access-and-customize-output",children:"How does Magento flush output, and what mechanisms exist to access and customize output?"}),"\n",(0,i.jsx)(n.p,{children:"Render response:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"action controller returns ResponseInterface object, e.g. View\\Response\\Page"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"front controller returns this response"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"App\\Http.launch application renders result, calling response.renderResult"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"controller response renders contents and assigns to response.body"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"App\\Http"})," event ",(0,i.jsx)(n.code,{children:"controller_front_send_response_before"})," allows to modify response before returning"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"App\\Bootstrap"})," object gets response object from ",(0,i.jsx)(n.code,{children:"App\\Http"})]}),"\n",(0,i.jsx)(n.li,{children:"response.sendResponse - Zend implementation - send headers, send content"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Customize:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["modify any response in event ",(0,i.jsx)(n.code,{children:"controller_front_send_response_before"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"View\\Element\\AbstractBlock::toHtml"})," event ",(0,i.jsx)(n.code,{children:"view_block_abstract_to_html_after"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"Determine-module-layout-XML-schema",children:"Determine module layout XML schema."}),"\n",(0,i.jsx)(n.p,{children:"Module layouts:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"module/view/base/layout/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"module/view/frontend/layout/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"module/view/adminhtml/layout/"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"layout_genericxsd",children:"layout_generic.xsd"}),"\n",(0,i.jsx)(n.p,{children:"Generic layout - useful for returning Ajax response. Doesn't have body, head, css etc., only pure structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<layout xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/layout_generic.xsd">\n  <container\n    name="" as="" after="" before="" label=""\n    output=""\n    htmlTag="" htmlClass="" htmlId=""\n  />\n  <referenceContainer\n    name="" label=""\n    htmlTag="" htmlClass="" htmlId=""\n    display="true/false"\n    remove="true/false"\n  />\n  <block\n    class="" name="" as="" template="" before="" after="" group=""\n    acl="" aclResource="" ifconfig=""\n    output="" cacheable="bool" ttl="int"\n  />\n  <referenceBlock name="" template="" display="" remove="" />\n  <update handle="name" />\n  <move element="" destination="" as="" after="" before="" />\n  <uiComponent\n    component="" name="" as="" before="" after="" group=""\n    aclResource="" ifconfig=""\n    output="" cacheable="" ttl=""\n  />\n</config>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"page_configurationxsd",children:"page_configuration.xsd"}),"\n",(0,i.jsx)(n.p,{children:"Same as layout plus:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"top level layout selection"}),"\n",(0,i.jsx)(n.li,{children:"structure is wrapped in body node"}),"\n",(0,i.jsx)(n.li,{children:"additional nodes - html attribute, head title, attribute and scripts"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<page\n  layout="1column"\n  label=""\n  design_abstraction="custom / page_layout"\n\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd"\n>\n  <html>\n    <attribute name="" value="" />\n  </html>\n  <head>\n    <title>Title</title>\n    <css src defer ie_condition charset hreflang media rel rev sizes target type src_type />\n    <link src defer ie_condition charset hreflang media rel rev sizes target type src_type />\n    <meta content charset http-equiv name scheme />\n    <script src defer ie_condition async charset type src_type />\n    <remove src="" />\n    <attribute name="" value="" />\n  </head>\n  <update handle="" />\n  <body>\n    <attribute name="" value="" />\n    \x3c!-- container/block structure same as in generic layout --\x3e\n  </body>\n</page>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"layoutsxml---declare-available-page-layouts",children:"layouts.xml - declare available page layouts"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"<module_dir>/view/<area_code>/layouts.xml"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"<theme_dir>/<Namespace>_<Module>/layouts.xml"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"base:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"empty"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"frontend:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"1column - extends empty"}),"\n",(0,i.jsx)(n.li,{children:"2columns-left - extends 1column"}),"\n",(0,i.jsx)(n.li,{children:"2columns-right - same as 2columns-left"}),"\n",(0,i.jsx)(n.li,{children:"3columns - same as 2columns-left"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"adminhtml:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"admin-empty"}),"\n",(0,i.jsx)(n.li,{children:"admin-1column"}),"\n",(0,i.jsx)(n.li,{children:"admin-2columns-left"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"page_layoutxsd",children:"page_layout.xsd"}),"\n",(0,i.jsx)(n.p,{children:"Only containers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<layout xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_layout.xsd">\n  <referenceContainer />\n  <container />\n  <update />\n  <move />\n</layout>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"layout-resultrenderResult",children:"layout result.renderResult:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"layout.getOutput"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"layout.build"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"View\\Layout\\Builder.build:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"loadLayoutUpdates"}),"\n",(0,i.jsx)(n.li,{children:"generateLayoutXml"}),"\n",(0,i.jsx)(n.li,{children:"generateLayoutBlocks"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"create result page - adds default handles"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"page builder.build"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"all normal layout XML is collected and is about to create blocks"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"custom step before generating layout blocks"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"page-resultrenderResult",children:"page result.renderResult:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Result\\PageFactory.create"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\Result\\Page::addDefaultHandle"})," - ",(0,i.jsx)(n.code,{children:"default"}),", ",(0,i.jsx)(n.code,{children:"$fullActionName"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Page\\Config.publicBuild = build"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Page\\Builder.build - extends View\\Layout\\Builder, custom readPageLayout on step generateLayoutBlocks"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"(inherit) loadLayoutUpdates"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"(inherit) generateLayoutXml"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"generateLayoutBlocks - additionally *readPageLayout*"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"right before creating actual blocks, reads and merges page layout xml files"}),"\n",(0,i.jsxs)(n.li,{children:["new instance of ",(0,i.jsx)(n.code,{children:"View\\Model\\Layout\\Merge::load handles = '1column' -- uses subDir 'page_layout'"})]}),"\n",(0,i.jsxs)(n.li,{children:["`",(0,i.jsx)(n.em,{children:"interprets"})," found page nodes - schedules blocks. page layout instructions (root page template) are interpreted before others"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"original generateLayoutBlocks *interprets*, then runs *generators*"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:'check View\\Page\\Config.pageLayout, e.g. "1column"'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["adds default body classes - ",(0,i.jsx)(n.code,{children:"$fullActionName"}),", ",(0,i.jsx)(n.code,{children:"page-layout-$layout"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"renders block 'head.additional', 'require.js'"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"assigns vars 'requireJs', 'headContent', 'headAdditional', 'htmlAttributes', 'headAttributes', 'bodyAttributes', 'loaderIcon'"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"layout.getOutput -- already built"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"renderPage"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"result.template defined via app/etc/di.xml"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"include Magento_Theme::root.phtml"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"In-your-custom-controller-dont-forget-to-add-entity-specific-IDs",children:"In your custom controller don't forget to add entity-specific IDs:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"$page->addPageLayoutHandles(['id' => $category->getId()]);"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'- adds handle `$fullActionName_$param_$value` like `catalog_category_view_id_17`\n- informs full page cache of *entity specific page* `\\Magento\\Framework\\View\\EntitySpecificHandlesList::addHandle`\n\n    *`\\Magento\\PageCache\\Model\\Layout\\MergePlugin::beforeValidateUpdate - entity-specific layout handles must not contain TTL\n\n        e.g. catalog_category_view_id_15.xml: <block ttl="3600"> ... will throw error\n\n    * `\\Magento\\PageCache\\Observer\\ProcessLayoutRenderElement::_wrapEsi` - exclude entity-specific handles from ESI URL\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Layout\\Builder.build"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"loadLayoutUpdates"}),"\n",(0,i.jsx)(n.li,{children:"generateLayoutXml"}),"\n",(0,i.jsx)(n.li,{children:"generateLayoutBlocks"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Page\\Builder.build"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"extend generateLayoutBlocks"}),"\n",(0,i.jsx)(n.li,{children:"readPageLayout"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"File-Collector",children:"File Collector"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"View\\File\\CollectorInterface"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Decorator\\ModuleDependency"})," - Decorator that sorts view files according to dependencies between modules they belong to"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Decorator\\ModuleOutput - Decorator that filters out view files that belong to modules, output of which is prohibited"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Base - Source of base files introduced by modules"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Collector\\Base - Source of base files introduced by modules"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"view/base/, view/{$area}/"}),"\n",(0,i.jsx)(n.code,{children:"Collector\\Override\\Base - Source of view files that explicitly override base files introduced by modules"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"theme/{$namespace}_{$module}/"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Collector\\Theme - Source of view files introduced by a theme"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"theme/"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Collector\\Override\\ThemeModular - Source of view files that explicitly override modular files of ancestor themes"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"theme/{$namespace}_{$module}/{$themeVendor}/{$themeName}/"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Collector\\Library - Source of base layout files introduced by modules"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"lib_web/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"each inherited theme[]: theme/web/"})}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"How-do-you-add-new-elements-to-the-pages-introduced-by-a-given-module",children:"How do you add new elements to the pages introduced by a given module?"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<block class="module\\block\\class" template="new module template" ... />\n'})}),"\n",(0,i.jsx)(n.h2,{id:"Demonstrate-the-ability-to-use-layout-fallback-for-customizations-and-debugging",children:"Demonstrate the ability to use layout fallback for customizations and debugging."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Element\\Template::getTemplateFile"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Element\\Template\\File\\Resolver::getTemplateFileName(template, [module, area]) -- just caches in memory"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\FileSystem::getTemplateFileName -- detects module by Module_Name::template.phtml, adds default params"}),"\n",(0,i.jsx)(n.code,{children:"* View\\Asset\\Repository::updateDesignParams - adds default missing params [object themeModel, locale]"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Design\\FileResolution\\Fallback\\TemplateFile.getFile(area, ) -- minify html"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Design\\FileResolution\\Fallback\\File.getFile -- calls resolver type='file'"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"View\\Design\\FileResolution\\Fallback\\Resolver\\Simple.resolve"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\Design\\Fallback\\RulePool.getRule"})," - by type: file, locale file, template file"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"File fallback rule"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["when missing 'module_name':","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"<theme_dir>"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["when set 'module_name':","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"<theme_dir>/<module_name>/templates"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"<module_dir>/view/<area_code>/templates"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"<module_dir>/view/base/templates"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"View\\Design\\FileResolution\\Fallback\\Resolver\\Simple::resolveFile(fileRule)"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"search file in each directory"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"How-do-you-identify-which-exact-layoutxml-file-is-processed-in-a-given-scope",children:"How do you identify which exact layout.xml file is processed in a given scope?"}),"\n",(0,i.jsx)(n.h2,{id:"How-does-Magento-treat-layout-XML-files-with-the-same-names-in-different-modules",children:"How does Magento treat layout XML files with the same names in different modules?"}),"\n",(0,i.jsx)(n.p,{children:'They are merged in module sequence order. Additionally, modules marked as "disable module output"\nare skipped (though deprecated).'}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Decorator\\ModuleDependency"})," - Decorator that sorts\nview files according to dependencies between modules they belong to"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Decorator\\ModuleOutput"})," - Decorator that filters out\nview files that belong to modules, output of which is prohibited"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"View\\File\\Collector\\Base"})," - Source of base files introduced by modules"]}),"\n",(0,i.jsx)(n.h2,{id:"Identify-the-differences-between-admin-and-frontend-scopes",children:"Identify the differences between admin and frontend scopes."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"customized layout builder and page builders - automatically init messages block"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["custom parent ",(0,i.jsx)(n.code,{children:"\\Magento\\Backend\\Block\\AbstractBlock"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"auto inject AuthorizationInterface"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["custom parent ",(0,i.jsx)(n.code,{children:"\\Magento\\Backend\\Block\\Template"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"available some properties - authorization, mathRandom, backendSession, formKey, class nameBuilder"}),"\n",(0,i.jsxs)(n.li,{children:["event ",(0,i.jsx)(n.code,{children:"adminhtml_block_html_before"})," - fired only when non-cached render.\nTo compare, event ",(0,i.jsx)(n.code,{children:"view_block_abstract_to_html_after"})," fires even when block loaded from cache"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:'customized "block" layout reader (runs interpret) -- reads "acl" block attribute'}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:['customzied "block" layout generator - default block ',(0,i.jsx)(n.code,{children:"class=Magento\\Backend\\Block\\Template"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"controller result object with additional methods:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"setActiveMenu"}),"\n",(0,i.jsx)(n.li,{children:"addBreadcrumb"}),"\n",(0,i.jsx)(n.li,{children:"addContent(block) - moves to 'content'"}),"\n",(0,i.jsx)(n.li,{children:"addLeft(block)"}),"\n",(0,i.jsx)(n.li,{children:"addJs"}),"\n",(0,i.jsx)(n.li,{children:"moveBlockToContainer"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"What-differences-exist-for-layout-initialization-for-the-admin-scope",children:"What differences exist for layout initialization for the admin scope?"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Custom layout and page builders"})," - automatically initializes message block from message manager:\n",(0,i.jsx)(n.code,{children:"\\Magento\\Backend\\Model\\View\\Layout\\Builder"})," and ",(0,i.jsx)(n.code,{children:"\\Magento\\Backend\\Model\\View\\Page\\Builder"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["afterGenerateBlock - called in the end of generateLayoutBlocks, the end of generation - ",(0,i.jsx)(n.code,{children:"layout->initMessages()"})]}),"\n",(0,i.jsx)(n.li,{children:"getBlock('messages') or create new one"}),"\n",(0,i.jsx)(n.li,{children:"addMessages from Message\\ManagerInterface"}),"\n",(0,i.jsx)(n.li,{children:"addStorageType('default')"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>o,x:()=>r});var i=l(6540);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);